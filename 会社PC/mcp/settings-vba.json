{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "_comment": "VBA / Excel 開発向け MCP設定",
  "_usage": "このファイルの mcpServers 部分を ~/.claude/settings.json にマージ",
  "_note": "VBA専用MCPは現時点で公式には存在しないため、汎用MCPの組み合わせで対応",

  "mcpServers": {
    "_comment_essential": "=== 必須: VBA開発基本MCP ===",

    "filesystem": {
      "_description": "Excel/VBAファイル（.xlsm, .bas, .cls）へのアクセス",
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "C:/Users/nakashima/Desktop/claude"
      ]
    },

    "memory": {
      "_description": "VBAモジュール構造・変数定義の記憶",
      "_importance": "VBA開発では特に重要 - プロシージャ間の依存関係を記憶",
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-memory"]
    },

    "sequential-thinking": {
      "_description": "複雑なVBAロジックの段階的設計",
      "_importance": "VBAの複雑なワークブック操作ロジックを整理",
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-sequential-thinking"]
    },

    "_comment_database": "=== データ連携 ===",

    "sqlite": {
      "_description": "VBAからのDB連携開発用",
      "_enabled": false,
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-sqlite",
        "--db-path",
        "C:/path/to/database.db"
      ]
    },

    "_comment_advanced": "=== オプション ===",

    "git": {
      "_description": "VBAコードのバージョン管理",
      "_note": "エクスポートした.bas/.clsファイルをGit管理",
      "_enabled": false,
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-git"]
    },

    "fetch": {
      "_description": "Web APIとの連携テスト",
      "_note": "VBAのHTTPリクエスト処理開発に有用",
      "_enabled": false,
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-fetch"]
    }
  },

  "_vba_development_workflow": {
    "step1_export": "VBEからモジュールを.bas/.clsとしてエクスポート",
    "step2_edit": "Claude Codeでコードを編集",
    "step3_import": "VBEにインポートして実行",
    "tips": [
      "filesystem MCPでエクスポートされた.bas/.clsファイルを管理",
      "memory MCPでモジュール間の依存関係を記憶",
      "複雑なマクロはsequential-thinking MCPで段階的に設計"
    ]
  },

  "_vba_file_types": {
    ".xlsm": "マクロ有効ブック",
    ".xlsb": "バイナリブック（マクロ可）",
    ".xla/.xlam": "アドイン",
    ".bas": "標準モジュール（エクスポート）",
    ".cls": "クラスモジュール（エクスポート）",
    ".frm": "ユーザーフォーム（エクスポート）"
  },

  "_custom_vba_mcp_idea": {
    "_description": "カスタムVBA MCPサーバーの実装案（Python + win32com）",
    "_features": [
      "VBAモジュール一覧取得",
      "モジュールのエクスポート/インポート",
      "VBAコードの実行",
      "ワークブック操作"
    ],
    "_implementation": "mcp-by-technology.md のVBAセクションを参照"
  }
}
